---
title: "aarch64: emission"
status: closed
priority: 2
issue-type: task
created-at: "\"2026-01-01T11:02:02.351259+02:00\""
closed-at: "\"2026-01-01T16:54:43.978541+02:00\""
close-reason: "\"completed: src/backends/aarch64/emit.zig with ARM64 binary encoding (mov/add/sub/ldr/str/stp/ldp/b/bl/br/ret/nop). All tests pass.\""
blocks:
  - hoist-474fd89be0902251
---

src/backends/aarch64/emit.zig (~4k LOC)

Port from: cranelift/codegen/src/isa/aarch64/inst/emit.rs

Binary encoding for ARM64:
- Fixed 32-bit instruction words
- Regular encoding formats

Encoding patterns:
- Data processing: sf|opc|shift|Rm|imm6|Rn|Rd
- Loads/stores: size|opc|imm|Rn|Rt
- Branches: op|imm26 or cond|imm19

Special encodings:
- Logical immediates (bitmask encoded)
- PC-relative addressing (+/- 1MB for ADR)
- Load literal pool

Each Inst variant has emit():
- 32-bit word written to buffer
- Branch fixups for labels
