---
title: "Implement P3: Register allocation, prologue/epilogue, emission"
status: closed
priority: 2
issue-type: task
created-at: "2026-01-07T10:34:32.536395+02:00"
closed-at: "2026-01-07T10:41:47.638362+02:00"
---

Critical path: All 3 functions in src/codegen/compile.zig are TODO stubs:
- allocateRegisters() - needs LinearScanAllocator integration or regalloc2 FFI
- insertPrologueEpilogue() - needs frame layout computation and prologue/epilogue generation
- emit() - needs to call backend emit with MachBuffer

Current state: Lowering (P2) is ~95% complete. Only calls and global_value remain, but tests fail because P3 is completely unimplemented.

Priority: This is now the critical blocking issue. Without P3, no code is emitted and nothing works.

Dependencies: None - can start immediately
Files: src/codegen/compile.zig, src/machinst/regalloc.zig, src/backends/aarch64/abi.zig, src/backends/aarch64/emit.zig
Estimated: 1-2 weeks of focused work
