---
title: Review full Cranelift compatibility - systematic audit of missing functionality
status: closed
priority: 2
issue-type: task
created-at: "2026-01-03T10:27:07.520061+02:00"
closed-at: "2026-01-03T12:40:48.468085+02:00"
---

COMPREHENSIVE CRANELIFT COMPATIBILITY AUDIT

OBJECTIVE: Systematically identify ALL missing Cranelift functionality in hoist and create detailed, granular dots for implementation.

METHODOLOGY:
1. Compare hoist IR against Cranelift IR (~/Work/wasmtime/cranelift/)
2. Identify missing instruction types, passes, backends
3. Break into atomic, implementable tasks with exact file locations
4. Work with human to validate completeness

AREAS TO AUDIT:

IR Layer (src/ir/):
- Instruction opcodes vs cranelift_codegen::ir::instructions
- Type system completeness vs cranelift_codegen::ir::types
- Memory/SIMD instruction support
- Atomic operations
- Exception handling primitives
- Missing DFG operations

Optimization Passes (src/codegen/):
- GVN (Global Value Numbering)
- LICM (Loop Invariant Code Motion)
- Constant folding
- Dead store elimination
- Alias analysis
- Inline expansion

Backend Support (src/backends/):
- AArch64 completeness vs cranelift-aarch64
- x64 completeness vs cranelift-x86
- Missing instruction lowering rules
- ABI calling convention gaps
- Register allocation edge cases

Verification (src/ir/verifier.zig):
- SSA form validation gaps
- Type checking completeness
- Dominator tree validation
- CFG well-formedness checks

Testing Infrastructure:
- Missing test coverage areas
- Fuzzing harnesses
- Benchmark suites

DELIVERABLE: Break this into 20-50 small, specific dots like:
- 'Add SIMD v128 type support - src/ir/types.zig needs vector types'
- 'Implement iconst folding pass - src/codegen/optimize.zig missing constant propagation'
- 'Add AArch64 SIMD lowering - src/backends/aarch64/lower.zig needs vector ops'

NEXT STEP: Human reviews Cranelift source and identifies first batch of missing features
