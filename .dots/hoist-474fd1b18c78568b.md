---
title: "ISLE: trie optimization"
status: closed
priority: 1
issue-type: task
created-at: "\"2026-01-01T11:00:06.326407+02:00\""
closed-at: "\"2026-01-01T16:32:34.568009+02:00\""
close-reason: "\"Created trie.zig (583 LOC) with Binding/Constraint IR, RuleSet with binding hash-consing, overlap detection, disjoint sets for equality constraints, and decision tree stubs. Added VariantId to sema.zig. All 14 tests pass. Total: ~10.8k LOC\""
blocks:
  - hoist-474fd1b17cff7356
---

src/dsl/isle/trie.zig (~1k LOC)

Port from: cranelift/isle/isle/src/trie_again.rs

Decision trie compilation:
- Converts flat rule list to decision tree
- Optimizes pattern matching order
- Handles overlapping patterns with priorities

Algorithm:
1. Group rules by constructor at each position
2. Build decision nodes for each constructor
3. Handle wildcards and bindings
4. Compute match priorities for ambiguous cases

Output: Trie structure ready for code generation
